Here is the content from the provided document, structured for explanation.

### [cite_start]Viterbi Decoder [cite: 1]

[cite_start]This material is from the course CS6230: CAD For VLSI[cite: 2].

---

### [cite_start]Hidden Markov Models (HMM) [cite: 3]

[cite_start]The Viterbi algorithm is commonly used with Hidden Markov Models (HMMs)[cite: 29]. An HMM has the following characteristics:

* [cite_start]**Markov Property:** The future state depends only on the current state, not on the events that occurred before it[cite: 5].
* [cite_start]**Hidden States:** The actual states of the system are not directly observable[cite: 6]. [cite_start]In the example diagram, "Rainy" and "Sunny" are hidden states[cite: 12, 16].
* [cite_start]**Observations:** One can only observe the outputs that are generated by the hidden states[cite: 7]. [cite_start]In the example, "Walk," "Shop," and "Clean" are observations[cite: 8, 25, 24].

### [cite_start]The Viterbi Algorithm [cite: 26]

* [cite_start]**Definition:** It is a dynamic programming algorithm[cite: 28].
* [cite_start]**Purpose:** It finds the most likely sequence of hidden states for a given sequence of observations[cite: 28].
* [cite_start]**Output:** The resulting sequence of hidden states is called the **Viterbi path**[cite: 30].

[cite_start]**Applications:** [cite: 31]
* [cite_start]Decoding convolutional codes in digital communication[cite: 32].
* [cite_start]Parts of speech tagging[cite: 32].

---

### [cite_start]Mathematical Formulation [cite: 33]

#### [cite_start]Definitions [cite: 39]

* [cite_start]**States ($q$):** $q_{0},q_{1},q_{2},...q_{N}$ (where $q_{0}$ is the start state)[cite: 34]. [cite_start]$N$ is the number of states[cite: 37].
* [cite_start]**Observations ($k$):** $k_{1},k_{2},....k_{M}$[cite: 36]. [cite_start]$M$ is the number of observations[cite: 38].
* [cite_start]**Input Sequence ($O$):** $O_{1} ,0_{2},0_{3},....,0_{T}$[cite: 39].
* [cite_start]**Transition Probabilities ($a_{ij}$):** The probability of transitioning from state $q_{i}$ to state $q_{j}$[cite: 39].
* [cite_start]**Emission Probabilities ($b_{j}(o_{t})$):** The probability of observing $o_{t}$ given the current state $q_{j}$[cite: 39].
* [cite_start]**Viterbi Path Probability ($v_{t}(j)$):** The probability of the most likely path ending in state $q_{j}$ at time $t$[cite: 39].

#### Formulas

1.  **Initialization (t=1):**
    * [cite_start]$V_{1}(j)={a_{q0,j}}^{*}b_{j}(o_{t})$ [cite: 41]

2.  **Recursive Step (t > 1):**
    * [cite_start]$V_{t}(j)=max_{(0\le i<N+1)}(V_{t-1}(i)^{*}{a_{ij}}^{*}b_{j}(o_{t}))$ [cite: 39, 40]

---

### [cite_start]Example Calculation [cite: 43]

* [cite_start]**States (N=2):** R (Rainy), S (Sunny)[cite: 44, 52, 54].
* [cite_start]**Observations (M=4):** 1 (Walk), 2 (Shop), 3 (Study), 4 (Clean)[cite: 45, 62, 63, 64, 65].
* [cite_start]**Problem:** Find the most probable sequence of weather given the observation sequence **1, 3, 4**[cite: 66, 68].

**Step-by-Step Solution:**

1.  **Time t=1 (Observation = 1):**
    * [cite_start]**$v_{1}(R)$:** $P(Start \to R) * P(R \to 1) = 0.5 * 0.1 = 0.05$[cite: 88, 89].
    * [cite_start]**$v_{1}(S)$:** $P(Start \to S) * P(S \to 1) = 0.5 * 0.3 = 0.15$[cite: 91, 92].
        * *Max probability at t=1 is $v_{1}(S)$ = 0.15.*

2.  **Time t=2 (Observation = 3):**
    * [cite_start]**$v_{2}(R)$:** This path has a probability of $0.15 * 0.24$[cite: 96]. [cite_start]The backtrace pointer $bt_{2}(R)$ points to S[cite: 96].
    * [cite_start]**$v_{2}(S)$:** This path has a probability of $0.15 * 0.08$[cite: 116].

3.  **Time t=3 (Observation = 4):**
    * [cite_start]**$v_{3}(R)$:** This path has a probability of $0.15 * 0.24 * 0.21$[cite: 106]. [cite_start]The backtrace pointer $bt_{3}(R)$ points to R[cite: 107].
    * [cite_start]**$v_{3}(S)$:** This path has a probability of $0.15 * 0.24 * 0.06$[cite: 113]. [cite_start]The backtrace pointer $bt_{3}(S)$ points to R[cite: 113].

**Termination & Backtrace:**

* [cite_start]The highest probability at t=3 is $v_{3}(R)$[cite: 106].
* **Path at t=3:** R
* [cite_start]**Path at t=2:** Follow backtrace from R at t=3, which is $bt_{3}(R)=R$[cite: 107].
* [cite_start]**Path at t=1:** Follow backtrace from R at t=2, which is $bt_{2}(R)=S$[cite: 96].

[cite_start]**Answer:** The most probable sequence is **S, R, R**[cite: 70].

---

### [cite_start]Pseudocode [cite: 118]

#### Variables
* [cite_start]`T`: Number of observations in the input sequence[cite: 119].
* [cite_start]`bt[t][j]`: Backtrace array that records the previous state leading to the max probability at state `j` at time `t`[cite: 120].
* [cite_start]`prob[]`: Array for the current max path probability ending at each state[cite: 120].
* [cite_start]`temp[]`: Temporary array to store updated probabilities[cite: 121].

#### 1. Initialization (t=1)
* For all states `j` from 1 to N:
    * [cite_start]`prob[j] = a[0][j] * b[j][]` [cite: 122]
    * [cite_start]`bt[1][j] = q_0` [cite: 124, 125]

#### 2. Iterative Step
* [cite_start]For each time step `t` from 2 to T: [cite: 126]
    * [cite_start]For each state `j` from 1 to N: [cite: 127]
        * [cite_start]`max_val = 0` [cite: 130]
        * [cite_start]`max_state = -1` [cite: 131]
        * [cite_start]For `i` in 1 to N: [cite: 132]
            * [cite_start]`val = prob[i] * a[i][j] * b[j][0]` [cite: 133]
            * [cite_start]If `val > max_val`: [cite: 135]
                * [cite_start]`max_val = val` [cite: 136]
                * [cite_start]`max_state = i` [cite: 137]
        * [cite_start]`temp[j] = max_val` [cite: 138]
        * [cite_start]`bt[t][j] = max_state` [cite: 138]
    * [cite_start]`prob = temp` (copy temp array to prob) [cite: 139]

#### [cite_start]3. Termination [cite: 141]
* [cite_start]`path[]`: Final Viterbi path[cite: 142].
* [cite_start]`vprob`: Final probability of the most likely sequence[cite: 143].
* [cite_start]`vprob = 0` [cite: 144]

* **Find end of path:**
    * [cite_start]For `i` in 1 to N: [cite: 145]
        * [cite_start]If `prob[i] > vprob`: [cite: 147]
            * [cite_start]`vprob = prob[i]` [cite: 148]
            * [cite_start]`path[T] = i` [cite: 149]

* **Backtrace path:**
    * [cite_start]For `t` in T-1 down to 1: [cite: 151]
        * [cite_start]`path[t] = bt[t+1][path[t+1]]` [cite: 153]